<!DOCTYPE html>
<html lang="en">
<head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-ML3F7KLZ');</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Burnout Diagnostic • Career Health | QuizRealm</title>
    <meta name="description" content="Are you just tired, or fully burnt out? A 13-point audit of your exhaustion, cynicism, and effectiveness at work.">
    <meta name="theme-color" content="#020617">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Outfit:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="components.js" defer></script>
    <script type="module" src="game-engine.js"></script>
    <script type="module" src="assets/ux-core.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 
                        'serif': ['DM Serif Display', 'serif'], 
                        'sans': ['Outfit', 'sans-serif'] 
                    },
                    colors: { 
                        'burn-bg': '#020617',      // Deep slate
                        'burn-panel': '#020617',
                        'burn-panel-soft': '#0f172a',
                        'burn-accent': '#f97316',  // Orange
                        'burn-accent-soft': '#fb923c',
                        'burn-muted': '#94a3b8',
                        'burn-ink': '#e5e7eb'
                    },
                    boxShadow: {
                        'soft': '0 24px 60px -30px rgba(15,23,42,0.9)',
                        'lift': '0 18px 40px -22px rgba(15,23,42,0.95)'
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite'
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background:
                radial-gradient(circle at top, rgba(248,250,252,0.06) 0, transparent 55%),
                radial-gradient(circle at bottom, rgba(248,113,113,0.15) 0, #020617 60%);
            color: #e5e7eb;
            font-family: 'Outfit', sans-serif;
            overflow-x: hidden;
        }
        
        .shape-blob {
            position: absolute;
            border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.7;
            animation: float 10s infinite;
        }

        .spa-card {
            background: radial-gradient(circle at top left, rgba(15,23,42,0.98), rgba(15,23,42,1));
            border-radius: 1.5rem;
            box-shadow: 0 24px 60px -30px rgba(15,23,42,0.9);
            border: 1px solid rgba(148,163,184,0.45);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .btn-option {
            background: #020617;
            border: 1px solid rgba(148,163,184,0.5);
            transition: all 0.2s cubic-bezier(0.25,0.46,0.45,0.94);
        }
        .btn-option:hover {
            border-color: #f97316;
            background: #020617;
            transform: translateY(-2px);
            box-shadow: 0 18px 45px -26px rgba(248,113,113,0.8);
        }

        .btn-cta {
            background: #f97316;
            color: #020617;
            transition: all 0.3s ease;
            letter-spacing: 0.2em;
            text-transform: uppercase;
        }
        .btn-cta:hover {
            background: #ffffff;
            color: #020617;
            transform: translateY(-1px);
            box-shadow: 0 0 30px rgba(248,113,113,0.9);
        }

        .progress-track {
            background: #020617;
            height: 8px;
            border-radius: 999px;
            overflow: hidden;
            border: 1px solid rgba(30,64,175,0.5);
        }
        .progress-fill {
            background: linear-gradient(90deg,#f97316,#fb923c);
            height: 100%;
            border-radius: 999px;
            transition: width 0.5s ease;
        }

        .highlight {
            position: relative;
            display: inline-block;
        }
        .highlight::after {
            content: "";
            position: absolute;
            bottom: 0.1em;
            left: 0;
            width: 100%;
            height: 0.45em;
            background: rgba(248,113,113,0.35);
            z-index: -1;
            border-radius: 999px;
        }
    </style>
</head>

<body class="flex flex-col min-h-screen">
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-ML3F7KLZ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="shape-blob bg-fuchsia-500/30 w-96 h-96 top-0 right-0 translate-x-1/3 -translate-y-1/3"></div>
        <div class="shape-blob bg-emerald-500/20 w-80 h-80 bottom-0 left-0 -translate-x-1/3 translate-y-1/3"></div>
    </div>

    <quiz-header style="color: #e5e7eb;"></quiz-header>

    <main class="flex-grow w-full max-w-2xl mx-auto px-6 py-16 relative z-10">

        <!-- START SCREEN -->
        <div id="start-screen" class="text-center space-y-10 animate-float" style="animation-duration: 8s;">
            
            <div class="w-20 h-20 bg-slate-900 border border-slate-700 text-amber-400 rounded-2xl flex items-center justify-center mx-auto text-3xl shadow-soft">
                <i class="fas fa-battery-quarter"></i>
            </div>

            <div>
                <h1 class="font-serif text-4xl md:text-5xl text-slate-50 mb-5 leading-tight">
                    The Burnout <br><span class="highlight">Diagnostic.</span>
                </h1>
                <p class="text-sm md:text-base text-burn-muted leading-relaxed max-w-md mx-auto">
                    Are you just tired, or are you mentally running Windows 95 on 2% battery?  
                    This test maps your <span class="text-amber-400 font-semibold">Exhaustion</span>, 
                    <span class="text-rose-400 font-semibold">Cynicism</span>, and 
                    <span class="text-sky-300 font-semibold">Effectiveness</span> at work.
                </p>
            </div>

            <div class="grid grid-cols-3 gap-4 text-[10px] md:text-xs font-bold text-burn-muted uppercase tracking-[0.25em] border-y border-slate-800 py-6">
                <div class="flex flex-col items-center gap-1">
                    <i class="fas fa-brain text-lg md:text-xl text-amber-300"></i>
                    <span>Mental Load</span>
                </div>
                <div class="flex flex-col items-center gap-1">
                    <i class="fas fa-heart-crack text-lg md:text-xl text-rose-400"></i>
                    <span>Emotional Drag</span>
                </div>
                <div class="flex flex-col items-center gap-1">
                    <i class="fas fa-bolt text-lg md:text-xl text-sky-300"></i>
                    <span>Output</span>
                </div>
            </div>

            <button onclick="window.startQuiz()" class="btn-cta px-10 py-4 text-[11px] font-bold rounded-full shadow-lift">
                Start Diagnostic
            </button>

            <p class="text-[10px] text-slate-500 max-w-sm mx-auto">
                This is not a medical tool. If your answers reflect extreme distress, consider talking to a mental health professional.  
                This quiz just tells you how cooked you are in corporate terms.
            </p>
        </div>

        <!-- QUIZ INTERFACE -->
        <div id="quiz-interface" class="hidden min-h-[50vh] flex flex-col justify-center">
            
            <div class="mb-12">
                <div class="flex justify-between items-end mb-3">
                    <span class="text-[10px] font-bold uppercase text-amber-300 tracking-[0.3em]" id="q-category">Category</span>
                    <span class="text-[10px] font-mono text-burn-muted" id="timer-display">00:00</span>
                </div>
                <div class="progress-track">
                    <div id="progress-bar" class="progress-fill" style="width: 0%"></div>
                </div>
            </div>

            <h2 id="question-text" class="font-serif text-2xl md:text-3xl text-slate-50 mb-10 leading-snug">
                Loading question...
            </h2>

            <div id="options-container" class="space-y-4"></div>
        </div>

        <!-- RESULT SCREEN -->
        <div id="result-screen" class="hidden text-center">
            
            <div class="spa-card p-8 md:p-10 mb-8">
                <span class="text-[10px] uppercase tracking-[0.3em] text-burn-muted mb-4 block">Current Status</span>
                
                <h2 class="font-serif text-3xl md:text-5xl text-slate-50 mb-2 leading-none">
                    <span id="result-title">Loading...</span>
                </h2>
                
                <h3 id="result-subtitle" class="text-amber-300 font-sans font-bold text-[11px] uppercase tracking-[0.35em] mb-6">
                    Loading...
                </h3>

                <p id="result-summary" class="text-sm md:text-base text-burn-muted leading-relaxed font-light max-w-xl mx-auto">
                    Processing your stress profile...
                </p>
            </div>

            <div class="space-y-4">
                <button
                    onclick="document.getElementById('full-report').classList.toggle('hidden')"
                    class="w-full bg-slate-900 border border-slate-700 py-4 rounded-xl text-[10px] font-bold uppercase tracking-[0.3em] text-burn-muted hover:text-slate-50 hover:bg-slate-800 transition flex items-center justify-center gap-2">
                    <span>View Clinical Breakdown</span>
                    <i class="fas fa-chevron-down text-[9px]"></i>
                </button>
                
                <div id="full-report" class="hidden spa-card p-7 md:p-8 text-left space-y-6">
                    <p id="result-desc" class="text-burn-muted text-sm leading-loose">
                        Description...
                    </p>
                    
                    <div class="space-y-4 pt-4 border-t border-slate-800">
                        <div>
                            <div class="flex justify-between text-[10px] font-bold uppercase text-burn-muted mb-1">
                                <span>Exhaustion Level</span><span id="val-exhaustion">0%</span>
                            </div>
                            <div class="h-2 bg-slate-900 rounded-full">
                                <div id="bar-exhaustion" class="h-full bg-amber-400 rounded-full" style="width:0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-[10px] font-bold uppercase text-burn-muted mb-1">
                                <span>Cynicism Score</span><span id="val-cynicism">0%</span>
                            </div>
                            <div class="h-2 bg-slate-900 rounded-full">
                                <div id="bar-cynicism" class="h-full bg-rose-400 rounded-full" style="width:0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-[10px] font-bold uppercase text-burn-muted mb-1">
                                <span>Efficacy Gap</span><span id="val-efficacy">0%</span>
                            </div>
                            <div class="h-2 bg-slate-900 rounded-full">
                                <div id="bar-efficacy" class="h-full bg-sky-400 rounded-full" style="width:0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-[10px] font-bold uppercase text-burn-muted mb-1">
                                <span>Detachment Index</span><span id="val-detachment">0%</span>
                            </div>
                            <div class="h-2 bg-slate-900 rounded-full">
                                <div id="bar-detachment" class="h-full bg-slate-400 rounded-full" style="width:0%"></div>
                            </div>
                        </div>
                    </div>

                    <p class="text-[10px] text-slate-500 pt-2">
                        This is a reflection tool, not a diagnosis. If you are feeling hopeless, unsafe, or unable to cope,
                        please reach out to someone you trust or a professional in your country.
                    </p>
                </div>

                <div class="flex flex-col sm:flex-row gap-4 pt-4">
                    <button onclick="shareResult()" class="btn-cta px-6 py-4 rounded-xl flex-1 text-[10px] font-bold uppercase tracking-[0.3em]">
                        Share Status
                    </button>
                    <a href="arcade.html" class="bg-slate-900 border border-slate-700 text-burn-ink px-6 py-4 rounded-xl flex-1 text-[10px] font-bold uppercase tracking-[0.3em] hover:bg-slate-800 text-center">
                        Recovery Arcade
                    </a>
                </div>
            </div>

        </div>

    </main>

    <script type="module">
        // ================= CONFIG =================
        // Scores: Ex (Exhaustion), Cy (Cynicism), Ef (Efficacy gap – higher = feeling less effective)
        const questions = [
            { q: "How do you feel on Sunday night?", cat: "Anticipation",
              a: [
                  { text: "Pretty calm. Next week is fine.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "Mild dread and background anxiety.", scores: { Ex: 10, Cy: 5, Ef: 0 } },
                  { text: "Heavy dread. Brain already screaming 'no'.", scores: { Ex: 25, Cy: 20, Ef: 10 } }
              ] 
            },
            { q: "When you get a new work email notification, you…", cat: "Reaction",
              a: [
                  { text: "Open it, deal with it, move on.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "Feel an instant spike of anger.", scores: { Ex: 10, Cy: 25, Ef: 0 } },
                  { text: "Ignore it. Emotionally offline.", scores: { Ex: 20, Cy: 10, Ef: 20 } }
              ] 
            },
            { q: "Your sleep lately is…", cat: "Physical Load",
              a: [
                  { text: "Solid. I wake up rested most days.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "Broken. I wake up tired no matter what.", scores: { Ex: 25, Cy: 5, Ef: 10 } },
                  { text: "Work keeps sneaking into my dreams.", scores: { Ex: 15, Cy: 15, Ef: 0 } }
              ] 
            },
            { q: "Your honest opinion of your coworkers:", cat: "Social Climate",
              a: [
                  { text: "Mostly fine. Normal humans.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "A mix of chaos, incompetence, and noise.", scores: { Ex: 5, Cy: 25, Ef: 5 } },
                  { text: "I feel too drained to care either way.", scores: { Ex: 20, Cy: 10, Ef: 20 } }
              ] 
            },
            { q: "How effective do you feel at work?", cat: "Efficacy",
              a: [
                  { text: "Pretty effective. I get things done well.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "I work hard but nothing moves forward.", scores: { Ex: 15, Cy: 10, Ef: 25 } },
                  { text: "I do the bare minimum to avoid trouble.", scores: { Ex: 5, Cy: 20, Ef: 20 } }
              ] 
            },
            { q: "Your main reason for working right now is…", cat: "Motivation",
              a: [
                  { text: "Challenge, growth, and progress.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "Money and survival. End of list.", scores: { Ex: 10, Cy: 15, Ef: 10 } },
                  { text: "Fear of failing or disappointing people.", scores: { Ex: 20, Cy: 5, Ef: 15 } }
              ] 
            },
            { q: "Small problems at work (bugs, delays, extra tasks) make you…", cat: "Resilience",
              a: [
                  { text: "Annoyed, but I handle them.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "Unreasonably angry for the size of the problem.", scores: { Ex: 15, Cy: 25, Ef: 5 } },
                  { text: "Weirdly close to tears or shutdown.", scores: { Ex: 25, Cy: 5, Ef: 15 } }
              ] 
            },
            { q: "After work, you realistically have energy for…", cat: "Recovery",
              a: [
                  { text: "Hobbies, social life, moving my body.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "Light activities or a show, then bed.", scores: { Ex: 15, Cy: 5, Ef: 5 } },
                  { text: "Scrolling, collapsing, or staring at nothing.", scores: { Ex: 30, Cy: 10, Ef: 20 } }
              ] 
            },
            { q: "Your caffeine situation:", cat: "Coping",
              a: [
                  { text: "1–2 coffees/teas. Nothing extreme.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "I drink a lot but barely feel it anymore.", scores: { Ex: 20, Cy: 0, Ef: 10 } },
                  { text: "I run on stress and vibes more than caffeine.", scores: { Ex: 25, Cy: 5, Ef: 5 } }
              ] 
            },
            { q: "When someone asks \"How’s work?\" you usually say…", cat: "Identity",
              a: [
                  { text: "\"It’s good\" — and I mean it.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "\"Busy\" — code for: I’m not okay.", scores: { Ex: 10, Cy: 10, Ef: 5 } },
                  { text: "I dodge the question completely.", scores: { Ex: 5, Cy: 20, Ef: 10 } }
              ] 
            },
            { q: "You feel your work…", cat: "Meaning",
              a: [
                  { text: "Has some purpose or value.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "Is mostly pointless busywork.", scores: { Ex: 5, Cy: 30, Ef: 20 } },
                  { text: "Is actively draining the life out of me.", scores: { Ex: 25, Cy: 20, Ef: 10 } }
              ] 
            },
            { q: "How often do you think about quitting or changing everything?", cat: "Escape",
              a: [
                  { text: "Rarely. It crosses my mind sometimes.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "Every week, especially Monday.", scores: { Ex: 10, Cy: 15, Ef: 5 } },
                  { text: "I have a mental (or actual) exit plan ready.", scores: { Ex: 10, Cy: 30, Ef: 10 } }
              ] 
            },
            { q: "Be honest: overall, are you okay right now?", cat: "Self-Check",
              a: [
                  { text: "Yes. Stressed sometimes, but overall okay.", scores: { Ex: 0, Cy: 0, Ef: 0 } },
                  { text: "Not great, but still holding it together.", scores: { Ex: 15, Cy: 5, Ef: 10 } },
                  { text: "No. I feel spent most of the time.", scores: { Ex: 25, Cy: 25, Ef: 25 } }
              ] 
            }
        ];

        const archetypes = {
            "CrispyFried": {
                title: "Crispy Fried",
                subtitle: "System Overload.",
                summary: "You are not just tired. You are cooked. The tank is empty and you’re still flooring it.",
                desc: "Your exhaustion and cynicism are both very high. You are operating in survival mode, not growth mode. Concentration, memory, and mood are probably all worse than you admit. This is not about motivation anymore — it’s about capacity. You need real rest, fewer demands, and an honest look at what needs to change long term."
            },
            "Zombie": {
                title: "High-Functioning Zombie",
                subtitle: "You perform. You don’t feel.",
                summary: "The work gets done, but you feel emotionally unplugged while doing it.",
                desc: "You keep showing up, hitting deadlines, and ticking boxes — but your emotional connection to work is gone. This detachment is a defense mechanism: your brain is protecting you from feeling overwhelmed. Short term, it works. Long term, it flattens everything: joy, pride, and motivation. You don’t need to “push harder”; you need to reconnect to things that feel alive."
            },
            "Resentment": {
                title: "The Resentment Engine",
                subtitle: "Fueled by irritation.",
                summary: "You’re running mostly on anger and contempt at this point.",
                desc: "Your cynicism is leading the charge. You see the flaws, the incompetence, the unfairness — and you’re not wrong. But staying in permanent “everyone here is an idiot” mode fries you from the inside out. Your nervous system doesn’t care if it’s real or imagined; constant anger still burns you out. You either change the environment, change your role, or change how long you plan to tolerate this."
            },
            "SundayScaries": {
                title: "The Sunday Scaries",
                subtitle: "Early-stage burnout.",
                summary: "You’re not collapsing yet, but the warning lights are clearly on.",
                desc: "Your scores are moderate across exhaustion and cynicism. You can still function and recover on weekends, but the Monday dread is real. You have a growing gap between the person you are at work and the person you are outside of it. This is the ideal stage to intervene: boundaries, sleep, small changes in workload, or even planning a medium-term exit."
            },
            "HustleBot": {
                title: "The Hustle Bot",
                subtitle: "\"It’s fine, I’ll just work more.\"",
                summary: "You’re trying to outrun burnout by pushing harder. Spoiler: that doesn’t end well.",
                desc: "You are highly exhausted but still obsessed with being effective. You ignore signals from your body and treat rest like a bug, not a feature. Your output is likely dropping even if your hours aren’t. You don’t need another productivity hack; you need to admit you’re not a machine and start cutting load, not adding tricks."
            },
            "Drifter": {
                title: "The Detached Drifter",
                subtitle: "Quiet quitting, loud numbness.",
                summary: "You’ve mentally stepped back to protect yourself, but now everything feels vague and pointless.",
                desc: "Your efficacy gap and cynicism are both high. You’ve reduced effort to survive, which does protect your energy, but it also erodes your sense of meaning. You are in “do as little as possible without consequences” mode. The next step isn’t ‘try harder’; it’s deciding what kind of work, environment, or schedule would actually feel worth showing up for."
            },
            "Zen": {
                title: "The Zen Master",
                subtitle: "Suspiciously regulated.",
                summary: "You have boundaries, a life, and the ability to log off. Who allowed this level of stability?",
                desc: "Your scores are low across exhaustion, cynicism, and gap in effectiveness. You understand that work is part of your life, not your entire identity. You rest, you say no, and you know when to close the laptop. Your main risk is normalizing unhealthy environments because you’re coping so well. Guard your boundaries; they’re doing the heavy lifting."
            }
        };

        // ================= LOGIC =================
        let currentQ = 0;
        let totalScores = { Ex: 0, Cy: 0, Ef: 0 };
        let startTime = 0;

        const $ = (id) => document.getElementById(id);

        window.startQuiz = function() {
            $("start-screen").style.display = 'none';
            $("quiz-interface").classList.remove('hidden');
            $("result-screen").classList.add('hidden');
            currentQ = 0;
            totalScores = { Ex: 0, Cy: 0, Ef: 0 };
            startTime = Date.now();
            updateTimer();
            renderQuestion();
            window.scrollTo({ top: 0, behavior: "smooth" });
        }

        function renderQuestion() {
            if (currentQ >= questions.length) {
                finishQuiz();
                return;
            }

            const q = questions[currentQ];
            $("q-category").innerText = q.cat;
            $("question-text").innerText = q.q;
            $("progress-bar").style.width = ((currentQ / questions.length) * 100) + "%";

            const container = $("options-container");
            container.innerHTML = '';

            q.a.forEach((opt) => {
                const btn = document.createElement('button');
                btn.className = "btn-option w-full p-5 md:p-6 text-left rounded-xl text-sm md:text-base font-medium text-slate-50";
                btn.innerText = opt.text;
                btn.onclick = () => handleAnswer(opt.scores);
                container.appendChild(btn);
            });
        }

        function handleAnswer(scores) {
            totalScores.Ex += scores.Ex;
            totalScores.Cy += scores.Cy;
            totalScores.Ef += scores.Ef;
            currentQ++;
            renderQuestion();
        }

        function finishQuiz() {
            const durationSec = Math.floor((Date.now() - startTime) / 1000);
            const { Ex, Cy, Ef } = totalScores;
            
            // Determine Archetype
            let resultKey = "Zen";
            if (Ex > 180 && Cy > 100) resultKey = "CrispyFried";
            else if (Ex > 150 && Ef < 50) resultKey = "HustleBot";
            else if (Cy > 150) resultKey = "Resentment";
            else if (Ef > 120 && Cy > 100) resultKey = "Drifter";
            else if (Ex > 100 && Cy < 50 && Ef > 100) resultKey = "Zombie";
            else if (Ex > 80 || Cy > 80) resultKey = "SundayScaries";
            else resultKey = "Zen";

            const data = archetypes[resultKey];

            $("quiz-interface").classList.add('hidden');
            $("result-screen").classList.remove('hidden');

            $("result-title").innerText = data.title;
            $("result-subtitle").innerText = data.subtitle;
            $("result-summary").innerText = data.summary;
            $("result-desc").innerText = data.desc;

            // Render metrics (normalized)
            const exhaustionPct = Math.min(100, Math.floor(Ex / 2.5));
            const cynicismPct  = Math.min(100, Math.floor(Cy / 2));
            const efficacyPct  = Math.min(100, Math.floor(Ef / 1.5));
            const detachment   = Math.min(100, Math.floor((Cy + Ef) / 4));

            $("val-exhaustion").innerText = exhaustionPct + "%";
            $("bar-exhaustion").style.width = exhaustionPct + "%";

            $("val-cynicism").innerText = cynicismPct + "%";
            $("bar-cynicism").style.width = cynicismPct + "%";

            $("val-efficacy").innerText = efficacyPct + "%";
            $("bar-efficacy").style.width = efficacyPct + "%";

            $("val-detachment").innerText = detachment + "%";
            $("bar-detachment").style.width = detachment + "%";

            const recoveryNeed =
                Ex > 150 ? "Urgent" :
                Ex > 80  ? "High"   :
                           "Maintenance";

            const payload = {
                testId: "burnout_diagnostic",
                timestamp: new Date().toISOString(),
                archetype: resultKey,
                metrics: {
                    exhaustion_level: Ex,
                    cynicism_score: Cy,
                    efficacy_gap: Ef,
                    detachment_index: detachment,
                    recovery_need: recoveryNeed,
                    time_taken_seconds: durationSec
                }
            };

            if (window.saveTestResult) {
                try {
                    window.saveTestResult(payload);
                } catch(e) { console.warn("saveTestResult error", e); }
            }

            if (window.GameEngine && typeof window.GameEngine.trackEvent === "function") {
                try {
                    window.GameEngine.trackEvent("test_complete", {
                        testId: "burnout_diagnostic",
                        archetype: resultKey,
                        exhaustion: Ex,
                        cynicism: Cy,
                        efficacy_gap: Ef
                    });
                } catch (e) {}
            }

            window.scrollTo({ top: 0, behavior: "smooth" });
        }

        async function shareResult() {
            const title = "The Burnout Diagnostic • QuizRealm";
            const arche = $("result-title").innerText;
            const summary = $("result-summary").innerText;

            const text =
                `I just ran the Burnout Diagnostic on QuizRealm.\n` +
                `Result: ${arche}.\n` +
                `${summary}\n` +
                `If this looks familiar, maybe you need a break too.`;

            const url = window.location.href;
            const combined = `${text}\n${url}`;

            if (navigator.share) {
                try {
                    await navigator.share({ title, text, url });
                    return;
                } catch (e) {}
            }

            if (navigator.clipboard && navigator.clipboard.writeText) {
                try {
                    await navigator.clipboard.writeText(combined);
                    alert("Result + link copied to clipboard.");
                    return;
                } catch (e) {}
            }

            alert("Share this:\n\n" + combined);
        }

        window.shareResult = shareResult;

        function updateTimer() {
            if ($("quiz-interface").classList.contains('hidden')) return;
            const now = Date.now();
            const diff = Math.floor((now - startTime) / 1000);
            const m = Math.floor(diff / 60).toString().padStart(2, '0');
            const s = (diff % 60).toString().padStart(2, '0');
            $("timer-display").innerText = `${m}:${s}`;
            requestAnimationFrame(updateTimer);
        }
    </script>
</body>
</html>
