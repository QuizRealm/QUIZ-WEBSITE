<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuizRealm â€¢ Command Center</title>
    <meta name="theme-color" content="#030712">
    
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-ML3F7KLZ');</script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Inter:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="assets/ux-core.js"></script>
    <script src="components.js" defer></script>
    <script src="game-engine.js" defer></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                        arcade: ['Bungee', 'cursive']
                    },
                    colors: {
                        brand: { 500: '#3b82f6', 600: '#2563eb' },
                        dark: { 900: '#030712', 800: '#0f172a', 700: '#1e293b' }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #030712; color: #f8fafc; }
        
        /* Professional Glassmorphism */
        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        }
        
        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: rgba(255,255,255,0.02); }
        .custom-scroll::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }

        /* Animations */
        @keyframes fade-in-up { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-enter { animation: fade-in-up 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        /* Themes */
        .theme-cyan h2 { color: #fff; }
        .theme-cyan a { color: #22d3ee; }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-ML3F7KLZ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <div class="fixed inset-0 z-0 pointer-events-none">
        <div class="absolute top-0 left-1/2 -translate-x-1/2 w-full h-[600px] bg-blue-600/10 blur-[120px] rounded-full mix-blend-screen"></div>
        <div class="absolute bottom-0 right-0 w-[500px] h-[500px] bg-purple-600/5 blur-[100px] rounded-full mix-blend-screen"></div>
    </div>

    <quiz-header></quiz-header>

    <main class="relative z-10 flex-grow max-w-[1400px] mx-auto w-full p-4 lg:p-8">
        
        <div class="glass-panel rounded-3xl overflow-hidden mb-8 animate-enter">
            <div class="h-48 md:h-64 bg-slate-800 relative group">
                <img id="coverImage" src="https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=2070" class="w-full h-full object-cover opacity-60 transition duration-700 group-hover:scale-105" alt="Banner">
                <div class="absolute inset-0 bg-gradient-to-t from-[#0f172a] via-[#0f172a]/40 to-transparent"></div>
                
                <div class="absolute top-6 right-6 flex items-center gap-3">
                    <span id="connectionStatus" class="px-3 py-1 rounded-full bg-black/50 backdrop-blur border border-white/10 text-xs font-mono text-slate-400 flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-slate-500"></span> Offline Mode
                    </span>
                </div>
            </div>

            <div class="px-6 md:px-10 pb-8 -mt-20 flex flex-col md:flex-row items-end md:items-center gap-6 relative">
                
                <div class="relative group cursor-pointer" onclick="window.randomizeAvatar()">
                    <div class="w-32 h-32 md:w-40 md:h-40 rounded-3xl bg-slate-900 border-4 border-[#0f172a] overflow-hidden shadow-2xl relative z-10">
                        <img id="profileAvatar" src="" class="w-full h-full object-cover" alt="Avatar">
                        <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition flex items-center justify-center text-white font-bold text-xs uppercase tracking-widest backdrop-blur-sm">
                            <i class="fas fa-random mr-2"></i> Randomize
                        </div>
                    </div>
                    <div class="absolute -bottom-2 -right-2 z-20 bg-blue-600 text-white text-xs font-black px-3 py-1 rounded-lg border-4 border-[#0f172a] shadow-lg">
                        LVL <span id="headerLevelDisplay">1</span>
                    </div>
                </div>

                <div class="flex-1 text-center md:text-left mb-2 md:mb-8">
                    <h1 class="text-3xl md:text-5xl font-black text-white tracking-tight leading-none mb-2 flex items-center justify-center md:justify-start gap-3">
                        <span id="profileName">Guest Hero</span>
                        <button onclick="toggleEditName()" class="text-slate-500 hover:text-white text-lg transition"><i class="fas fa-pen"></i></button>
                    </h1>
                    <div id="nameEditContainer" class="hidden flex items-center gap-2 mt-2">
                        <input type="text" id="nicknameInput" class="bg-black/50 border border-white/20 rounded px-3 py-1 text-white text-sm" maxlength="15">
                        <button onclick="saveName()" class="bg-blue-600 text-white px-3 py-1 rounded text-xs font-bold">SAVE</button>
                    </div>
                    <p id="profileRankTitle" class="text-blue-400 font-mono text-sm uppercase tracking-[0.2em]">NOVICE DRIFTER</p>
                </div>

                <div class="w-full md:w-1/3 mb-4 md:mb-8 bg-slate-900/80 p-4 rounded-xl border border-white/5 backdrop-blur-sm">
                    <div class="flex justify-between text-xs font-bold text-slate-400 mb-2">
                        <span>XP PROGRESS</span>
                        <span id="xpText" class="text-white">0 / 100</span>
                    </div>
                    <div class="h-3 w-full bg-black rounded-full overflow-hidden">
                        <div id="xpFill" class="h-full bg-gradient-to-r from-blue-600 to-cyan-400 w-0 transition-all duration-1000 relative">
                            <div class="absolute inset-0 bg-white/20 animate-pulse"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <div class="space-y-8 animate-enter" style="animation-delay: 0.1s">
                
                <div class="glass-panel p-6 rounded-2xl">
                    <h3 class="text-xs font-black text-slate-500 uppercase tracking-widest mb-6">Combat Record</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 bg-white/5 rounded-xl border border-white/5">
                            <div class="text-2xl font-black text-white" id="totalXP">0</div>
                            <div class="text-[10px] text-slate-400 uppercase font-bold">Lifetime XP</div>
                        </div>
                        <div class="p-4 bg-white/5 rounded-xl border border-white/5">
                            <div class="text-2xl font-black text-amber-400" id="totalCoins">0</div>
                            <div class="text-[10px] text-slate-400 uppercase font-bold">Coins Earned</div>
                        </div>
                        <div class="p-4 bg-white/5 rounded-xl border border-white/5">
                            <div class="text-2xl font-black text-emerald-400" id="currentStreak">0</div>
                            <div class="text-[10px] text-slate-400 uppercase font-bold">Day Streak</div>
                        </div>
                        <div class="p-4 bg-white/5 rounded-xl border border-white/5">
                            <div class="text-2xl font-black text-purple-400" id="gamesPlayed">0</div>
                            <div class="text-[10px] text-slate-400 uppercase font-bold">Matches</div>
                        </div>
                    </div>
                </div>

                <div class="glass-panel p-6 rounded-2xl">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xs font-black text-slate-500 uppercase tracking-widest">Trophy Case</h3>
                        <a href="achievements.html" class="text-xs text-blue-400 hover:text-white transition">View All</a>
                    </div>
                    <div id="trophyGrid" class="grid grid-cols-4 gap-2">
                        <div class="aspect-square rounded-lg bg-white/5 border border-white/5 flex items-center justify-center opacity-30"><i class="fas fa-lock text-slate-500"></i></div>
                        <div class="aspect-square rounded-lg bg-white/5 border border-white/5 flex items-center justify-center opacity-30"><i class="fas fa-lock text-slate-500"></i></div>
                        <div class="aspect-square rounded-lg bg-white/5 border border-white/5 flex items-center justify-center opacity-30"><i class="fas fa-lock text-slate-500"></i></div>
                        <div class="aspect-square rounded-lg bg-white/5 border border-white/5 flex items-center justify-center opacity-30"><i class="fas fa-lock text-slate-500"></i></div>
                    </div>
                </div>
            </div>

            <div class="glass-panel p-0 rounded-2xl overflow-hidden flex flex-col h-[500px] lg:h-auto animate-enter" style="animation-delay: 0.2s">
                <div class="p-6 border-b border-white/5 bg-[#0f172a]/80 backdrop-blur">
                    <h3 class="text-xs font-black text-slate-500 uppercase tracking-widest">Match History</h3>
                </div>
                <div id="historyFeed" class="flex-1 overflow-y-auto custom-scroll p-4 space-y-2">
                    <div class="flex flex-col items-center justify-center h-full text-slate-500 gap-2">
                        <i class="fas fa-ghost text-2xl opacity-50"></i>
                        <p class="text-sm">No recent data found.</p>
                    </div>
                </div>
            </div>

            <div class="space-y-8 animate-enter" style="animation-delay: 0.3s">
                
                <div class="glass-panel p-6 rounded-2xl relative overflow-hidden">
                    <div id="guestOverlay" class="absolute inset-0 z-20 bg-[#0f172a]/90 backdrop-blur-md flex flex-col items-center justify-center p-6 text-center">
                        <div class="w-12 h-12 bg-slate-800 rounded-full flex items-center justify-center mb-4 border border-white/10">
                            <i class="fas fa-user-secret text-slate-400 text-xl"></i>
                        </div>
                        <h3 class="text-white font-bold mb-2">Guest Profile</h3>
                        <p class="text-slate-400 text-xs mb-6">Your stats are saved locally. Sign in to sync across devices and secure your XP.</p>
                        
                        <button onclick="loginWithGoogle()" class="w-full bg-white text-black font-bold py-3 rounded-xl flex items-center justify-center gap-3 hover:bg-slate-200 transition mb-3">
                            <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="w-5 h-5"> Sync with Google
                        </button>
                    </div>

                    <div id="userAuthView" class="relative z-10 filter blur-sm transition-all duration-500">
                        <h3 class="text-xs font-black text-green-500 uppercase tracking-widest mb-4 flex items-center gap-2">
                            <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> Cloud Active
                        </h3>
                        <div class="mb-6">
                            <div class="text-[10px] text-slate-500 uppercase font-bold">Linked Email</div>
                            <div id="userEmail" class="text-white font-mono text-sm truncate">...</div>
                        </div>
                        <div class="mb-6">
                            <div class="text-[10px] text-slate-500 uppercase font-bold">User UID</div>
                            <div id="userId" class="text-slate-400 font-mono text-xs truncate">...</div>
                        </div>
                        <button onclick="handleLogout()" class="w-full py-2 rounded-lg border border-red-500/30 text-red-400 text-xs font-bold hover:bg-red-500/10 transition">
                            DISCONNECT
                        </button>
                    </div>
                </div>

                <div class="glass-panel p-6 rounded-2xl theme-cyan">
                    <h2 class="text-lg font-bold text-white mb-2">Prestige System</h2>
                    <p class="text-sm text-slate-400 mb-4">
                        In the Quiz Realm, knowledge is currency. Completing a "Perfect Run" in the Daily Challenge grants XP multipliers that accelerate your rise through the ranks.
                    </p>
                    <a href="achievements.html" class="text-cyan-400 text-sm font-bold hover:text-white transition">View All Ranks &rarr;</a>
                </div>

            </div>
        </div>

    </main>

    <div class="w-full max-w-[1200px] mx-auto px-4 mt-12 mb-8">
        <div class="glass-panel p-8 rounded-2xl border-l-4 border-cyan-500 bg-gradient-to-br from-[#060b18] to-[#0f172a]">
            <div class="flex flex-col md:flex-row gap-8 items-start">
                <div class="flex-1">
                    <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-cyan-500/10 border border-cyan-500/20 text-cyan-400 text-[10px] uppercase font-bold tracking-widest mb-4">
                        <i class="fas fa-crown"></i> Prestige System
                    </div>
                    <h2 class="text-2xl font-bold text-white mb-4">Global Status: <span class="text-cyan-400">Earn Your Rank</span></h2>
                    <p class="text-slate-400 text-sm leading-relaxed mb-4">
                        Don't just play anonymously. Sign in to track your <strong>Lifetime Stats</strong>. See which categories are your strongest and where you need improvement. Compare your "Brain Age" and reaction times against friends to see who truly has the sharpest mind in your circle.
                    </p>
                </div>
                <div class="w-full md:w-64 bg-black/20 rounded-xl p-4 border border-white/5">
                    <div class="text-[10px] text-slate-500 uppercase font-bold mb-3">Quick Actions</div>
                    <a href="achievements.html" class="flex items-center gap-3 p-3 rounded-lg bg-white/5 hover:bg-white/10 transition mb-2">
                        <i class="fas fa-trophy text-yellow-400"></i>
                        <span class="text-xs font-bold text-white">Trophy Room</span>
                    </a>
                    <a href="daily.html" class="flex items-center gap-3 p-3 rounded-lg bg-white/5 hover:bg-white/10 transition">
                        <i class="fas fa-calendar-day text-emerald-400"></i>
                        <span class="text-xs font-bold text-white">Daily Challenge</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <quiz-footer></quiz-footer>
<script type="module">
        // 1. IMPORT FIREBASE FUNCTIONS DIRECTLY
        import { signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { doc, getDoc, setDoc, collection, query, orderBy, limit, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const STORAGE_KEY = "QR_PROFILE";
        const ADJECTIVES = ["Cosmic", "Iron", "Shadow", "Neon", "Dark", "Scarlet", "Quantum", "Electric", "Rogue", "Mystic", "Savage", "Phantom"];
        const NOUNS = ["Goblin", "Avenger", "Knight", "Wizard", "Falcon", "Panther", "Guardian", "Hunter", "Storm", "Viper", "Hawk", "Titan"];
        
        let currentUser = null;

        // --- INIT ---
        async function initProfile() {
            // Wait for ux-core.js to initialize window.auth
            const check = setInterval(() => {
                if (window.auth && window.db) {
                    clearInterval(check);
                    setupAuthListener();
                }
            }, 100);
        }

        function setupAuthListener() {
            // Use the imported function, passing the global auth object
            onAuthStateChanged(window.auth, async (user) => {
                currentUser = user;
                if (user && !user.isAnonymous) {
                    renderLoggedInState(user);
                    await syncAndFetchData(user);
                } else {
                    renderGuestState();
                    loadLocalData();
                }
            });
        }

        // --- RENDERERS ---
        function renderLoggedInState(user) {
            document.getElementById('guestOverlay').classList.add('hidden');
            document.getElementById('userAuthView').classList.remove('blur-sm');
            document.getElementById('connectionStatus').innerHTML = `<span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span> Cloud Connected`;
            document.getElementById('connectionStatus').classList.replace('text-slate-400', 'text-green-400');
            document.getElementById('userEmail').textContent = user.email || "Google Account";
            document.getElementById('userId').textContent = user.uid;
        }

        function renderGuestState() {
            document.getElementById('guestOverlay').classList.remove('hidden');
            document.getElementById('userAuthView').classList.add('blur-sm');
            document.getElementById('connectionStatus').innerHTML = `<span class="w-2 h-2 rounded-full bg-slate-500"></span> Guest Mode`;
        }

        function updateUI(data) {
            const nickname = data.nickname || "Guest Hero";
            document.getElementById('profileName').textContent = nickname;
            document.getElementById('nicknameInput').value = nickname;
            
            const seed = data.avatarSeed || "Guest";
            document.getElementById('profileAvatar').src = `https://api.dicebear.com/7.x/adventurer-neutral/svg?seed=${encodeURIComponent(seed)}`;

            const xp = data.xp || 0;
            const level = Math.max(1, Math.floor(Math.sqrt(xp / 100)));
            
            const startXP = 100 * (level * level);
            const nextXP = 100 * ((level + 1) * (level + 1));
            const progress = Math.min(100, Math.max(0, ((xp - startXP) / (nextXP - startXP)) * 100));

            document.getElementById('headerLevelDisplay').textContent = level;
            document.getElementById('profileRankTitle').textContent = getRankTitle(level);
            document.getElementById('totalXP').textContent = xp.toLocaleString();
            document.getElementById('totalCoins').textContent = (data.coins || Math.floor(xp/10)).toLocaleString();
            document.getElementById('currentStreak').textContent = data.streak || 0;
            
            document.getElementById('xpText').textContent = `${xp} / ${nextXP}`;
            document.getElementById('xpFill').style.width = `${progress}%`;
        }

        // --- DATA LOADING ---
        function getLocalProfile() {
            try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {}; } catch { return {}; }
        }

        function loadLocalData() {
            let data = getLocalProfile();
            if (!data.nickname) {
                data.nickname = generateRandomName();
                data.avatarSeed = "Guest";
                data.xp = 0;
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            }
            updateUI(data);
            
            document.getElementById('historyFeed').innerHTML = `
                <div class="flex flex-col items-center justify-center h-full text-slate-500 gap-2 opacity-50">
                    <i class="fas fa-lock text-2xl"></i>
                    <p class="text-xs">Sign in to view match history</p>
                </div>
            `;
        }

        async function syncAndFetchData(user) {
            const heroRef = doc(window.db, "heroes", user.uid);
            try {
                const snap = await getDoc(heroRef);
                let cloudData = {};

                if (snap.exists()) {
                    cloudData = snap.data();
                    const local = getLocalProfile();
                    const merged = { ...local, ...cloudData }; // Merge
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(merged));
                    updateUI(merged);
                } else {
                    let local = getLocalProfile();
                    if(!local.nickname) local.nickname = generateRandomName();
                    await setDoc(heroRef, local, { merge: true });
                    updateUI(local);
                }
                fetchHistory(user.uid);
            } catch (e) { console.error("Sync error", e); }
        }

        async function fetchHistory(uid) {
            const feed = document.getElementById('historyFeed');
            feed.innerHTML = '<div class="text-center text-xs text-slate-500 mt-4">Loading stats...</div>';
            try {
                const historyRef = collection(window.db, "users", uid, "history");
                const q = query(historyRef, orderBy("timestamp", "desc"), limit(10));
                const querySnapshot = await getDocs(q);
                
                if (querySnapshot.empty) {
                    feed.innerHTML = '<div class="text-center text-xs text-slate-500 mt-4">No recent matches found.</div>';
                    return;
                }

                let html = '';
                querySnapshot.forEach((doc) => {
                    const h = doc.data();
                    const date = h.timestamp ? new Date(h.timestamp.seconds * 1000).toLocaleDateString() : 'Recent';
                    const icon = getGameIcon(h.game);
                    html += `
                        <div class="flex items-center gap-4 p-3 rounded-xl bg-white/5 border border-white/5 hover:bg-white/10 transition">
                            <div class="w-10 h-10 rounded-lg bg-black/40 flex items-center justify-center text-lg text-blue-400 border border-white/5">
                                <i class="${icon}"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-xs font-bold text-white uppercase">${h.game || 'Quiz'}</span>
                                    <span class="text-[10px] font-mono text-slate-500">${date}</span>
                                </div>
                                <div class="flex gap-3 text-[10px] text-slate-400">
                                    <span><i class="fas fa-star text-yellow-500/50 mr-1"></i>Score: ${h.score || 0}</span>
                                    <span><i class="fas fa-bolt text-blue-500/50 mr-1"></i>XP: ${h.xpEarned || 0}</span>
                                </div>
                            </div>
                        </div>`;
                });
                feed.innerHTML = html;
                document.getElementById('gamesPlayed').textContent = querySnapshot.size + "+";
            } catch (e) { console.error(e); }
        }

        // --- UTILS ---
        function generateRandomName() {
            const adj = ADJECTIVES[Math.floor(Math.random() * ADJECTIVES.length)];
            const noun = NOUNS[Math.floor(Math.random() * NOUNS.length)];
            return `${adj} ${noun}`;
        }

        function getGameIcon(gameName) {
            const g = (gameName || "").toLowerCase();
            if(g.includes('word')) return 'fas fa-font';
            if(g.includes('logic')) return 'fas fa-microchip';
            if(g.includes('rapid')) return 'fas fa-bolt';
            return 'fas fa-gamepad';
        }

        function getRankTitle(level) {
            if(level > 90) return "The Singularity";
            if(level > 50) return "System Lord";
            if(level > 20) return "Cyber Vanguard";
            return "The Drifter";
        }

        // --- EXPOSED FUNCTIONS ---
        window.toggleEditName = () => { document.getElementById('nameEditContainer').classList.toggle('hidden'); };

        window.saveName = async () => {
            const newName = document.getElementById('nicknameInput').value.trim();
            if (!newName) return;
            document.getElementById('profileName').textContent = newName;
            document.getElementById('nameEditContainer').classList.add('hidden');
            
            let data = getLocalProfile();
            data.nickname = newName;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            window.dispatchEvent(new CustomEvent("userUpdate", { detail: data }));

            if (currentUser && window.db) {
                try {
                    await setDoc(doc(window.db, "heroes", currentUser.uid), { nickname: newName }, { merge: true });
                } catch(e) {}
            }
        };

        window.randomizeAvatar = async () => {
            const seed = Math.random().toString(36).substring(7);
            document.getElementById('profileAvatar').src = `https://api.dicebear.com/7.x/adventurer-neutral/svg?seed=${seed}`;
            let data = getLocalProfile();
            data.avatarSeed = seed;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            window.dispatchEvent(new CustomEvent("userUpdate", { detail: data }));
            if (currentUser && window.db) {
                await setDoc(doc(window.db, "heroes", currentUser.uid), { avatarSeed: seed }, { merge: true });
            }
        };

        window.loginWithGoogle = async () => {
            try {
                const provider = new GoogleAuthProvider();
                // THIS IS THE FIX: Pass window.auth into the function
                await signInWithPopup(window.auth, provider);
            } catch (e) { 
                alert("Login failed: " + e.message);
                console.error(e);
            }
        };

        window.handleLogout = async () => {
            await signOut(window.auth);
            window.location.reload();
        };

        initProfile();
    </script>
</body>
</html>