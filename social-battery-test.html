<!DOCTYPE html>
<html lang="en">
<head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-ML3F7KLZ');</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Social Battery Diagnostic â€¢ Energy Audit | QuizRealm</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;600;800&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="components.js" defer></script>
    <script type="module" src="game-engine.js"></script>
    <script type="module" src="assets/ux-core.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 
                        'sans': ['Outfit', 'sans-serif'], 
                        'mono': ['JetBrains Mono', 'monospace'] 
                    },
                    colors: { 
                        'space': '#050505',
                        'cyber-lime': '#bef264', // Lime 300
                        'cyber-dim': '#365314'  // Lime 900
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #050505; color: #f8fafc; font-family: 'Outfit', sans-serif; }
        
        .battery-container {
            border: 4px solid #365314;
            padding: 4px;
            width: 80px;
            height: 140px;
            margin: 0 auto;
            position: relative;
        }
        .battery-cap {
            width: 40px; height: 10px; background: #365314;
            position: absolute; top: -14px; left: 50%; transform: translateX(-50%);
        }
        .battery-level {
            background: #bef264;
            width: 100%;
            height: 100%;
            transition: height 0.5s ease;
            box-shadow: 0 0 20px #bef264;
        }

        .option-card {
            background: #0f172a;
            border: 1px solid #1e293b;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .option-card:hover {
            background: #1e293b;
            border-color: #bef264;
            transform: translateY(-4px);
            box-shadow: 0 10px 20px -10px rgba(190, 242, 100, 0.2);
        }

        .scanline {
            width: 100%; height: 2px; background: rgba(190, 242, 100, 0.1);
            position: absolute; animation: scan 4s linear infinite;
        }
        @keyframes scan { from { top: 0%; } to { top: 100%; } }

        .reveal { animation: zoomIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; opacity: 0; }
        @keyframes zoomIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>

<body class="flex flex-col min-h-screen">
    <quiz-header style="color: #bef264;"></quiz-header>

    <main class="flex-grow w-full max-w-2xl mx-auto px-6 py-12 lg:py-24 relative">
        <div class="scanline"></div>

        <div id="start-screen" class="text-center space-y-10 reveal">
            <div class="battery-container">
                <div class="battery-cap"></div>
                <div class="battery-level animate-pulse" style="height: 20%"></div>
            </div>

            <div class="space-y-4">
                <h1 class="text-5xl md:text-7xl font-extrabold uppercase tracking-tighter">
                    Social <span class="text-cyber-lime italic">Battery.</span>
                </h1>
                <p class="text-slate-500 font-mono text-xs tracking-widest uppercase">Diagnostic v4.0 // Energy Audit</p>
            </div>

            <p class="text-slate-400 font-light leading-relaxed max-w-sm mx-auto">
                Discover your exact social limit. Are you a nuclear reactor or a AA battery in a flashlight?
            </p>

            <button onclick="window.startQuiz()" class="bg-cyber-lime text-space px-12 py-5 font-extrabold uppercase tracking-tighter hover:bg-white transition-colors duration-300">
                Initiate Scan
            </button>
        </div>

        <div id="quiz-interface" class="hidden space-y-12">
            <div class="flex justify-between items-end border-b border-cyber-dim pb-4">
                <div class="font-mono text-[10px] text-cyber-lime uppercase tracking-widest">
                    System: <span id="q-category">Active</span>
                </div>
                <div class="font-mono text-[10px] text-slate-500" id="progress-text">01 / 13</div>
            </div>

            <h2 id="question-text" class="text-3xl md:text-4xl font-bold text-white leading-tight uppercase tracking-tight">
                Loading...
            </h2>

            <div id="options-container" class="grid grid-cols-1 gap-4"></div>
        </div>

        <div id="result-screen" class="hidden text-center space-y-10 reveal">
            <div class="bg-slate-900/50 p-10 border border-slate-800 rounded-3xl space-y-4">
                <span class="text-[10px] uppercase font-bold tracking-[0.3em] text-cyber-lime">Audit Confirmed</span>
                <h2 id="result-title" class="text-5xl md:text-7xl font-extrabold text-white uppercase italic tracking-tighter">Archetype</h2>
                <p id="result-summary" class="text-slate-400 font-light leading-relaxed max-w-lg mx-auto">Summary...</p>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="bg-slate-900 border border-slate-800 p-4">
                    <div class="text-[10px] text-slate-500 uppercase mb-1">Resilience</div>
                    <div id="res-val" class="font-bold text-cyber-lime">...</div>
                </div>
                <div class="bg-slate-900 border border-slate-800 p-4">
                    <div class="text-[10px] text-slate-500 uppercase mb-1">Recovery</div>
                    <div id="rec-val" class="font-bold text-cyber-lime">...</div>
                </div>
                <div class="bg-slate-900 border border-slate-800 p-4">
                    <div class="text-[10px] text-slate-500 uppercase mb-1">Limit</div>
                    <div id="lim-val" class="font-bold text-cyber-lime">...</div>
                </div>
                <div class="bg-slate-900 border border-slate-800 p-4">
                    <div class="text-[10px] text-slate-500 uppercase mb-1">Class</div>
                    <div id="cla-val" class="font-bold text-cyber-lime">...</div>
                </div>
            </div>

            <div class="flex flex-col sm:flex-row gap-4 justify-center pt-8">
                <button onclick="shareResult()" class="bg-cyber-lime text-space px-10 py-4 font-extrabold uppercase tracking-widest text-xs">Share Energy Signature</button>
                <a href="index-funnels.html" class="border border-slate-700 text-slate-400 px-10 py-4 font-bold uppercase tracking-widest text-xs hover:text-white transition">Exit Terminal</a>
            </div>
        </div>

    </main>

    <quiz-footer></quiz-footer>

    <script type="module">
        const questions = [
            { q: "A friend texts 'WYD? Come over' at 9 PM on a Tuesday. You:", cat: "Spontaneity",
              a: [
                  { text: "On my way. I love late night chaos.", scores: { res: 20, rec: 0, tol: 20 } },
                  { text: "Heart the message, reply tomorrow morning.", scores: { res: 0, rec: 20, tol: 0 } },
                  { text: "Depends on who else is there.", scores: { res: 10, rec: 10, tol: 10 } }
              ] 
            },
            { q: "At a party, you spend most of your time:", cat: "Socializing",
              a: [
                  { text: "In the middle of the dance floor/crowd.", scores: { res: 25, rec: 0, tol: 25 } },
                  { text: "With the host's dog in the kitchen.", scores: { res: 0, rec: 25, tol: 0 } },
                  { text: "In a deep 1-on-1 talk on the balcony.", scores: { res: 15, rec: 10, tol: 5 } }
              ] 
            },
            { q: "Your phone rings. No caller ID. You:", cat: "Contact",
              a: [
                  { text: "Answer it immediately.", scores: { res: 20, rec: 0, tol: 15 } },
                  { text: "Stare at the screen until it stops vibrating.", scores: { res: 0, rec: 25, tol: 0 } },
                  { text: "Google the number while it's still ringing.", scores: { res: 5, rec: 15, tol: 5 } }
              ] 
            },
            { q: "Post-event recovery for you involves:", cat: "Recovery",
              a: [
                  { text: "A second, smaller party with inner circle.", scores: { res: 25, rec: 0, tol: 15 } },
                  { text: "Total silence, dark room, no screens.", scores: { res: 0, rec: 30, tol: 0 } },
                  { text: "Recapping everything with a best friend.", scores: { res: 15, rec: 15, tol: 10 } }
              ] 
            },
            { q: "You have 3 social events in 4 days. You feel:", cat: "Stamina",
              a: [
                  { text: "Excited. My schedule is finally full.", scores: { res: 30, rec: 0, tol: 20 } },
                  { text: "Terrified. I will need a week to recover.", scores: { res: 0, rec: 25, tol: 0 } },
                  { text: "I'll go to two and flake on the third.", scores: { res: 15, rec: 15, tol: 10 } }
              ] 
            },
            { q: "Small talk with a stranger in an elevator is:", cat: "Threshold",
              a: [
                  { text: "Easy. I usually start it.", scores: { res: 20, rec: 0, tol: 20 } },
                  { text: "Physical torture. I look at my shoes.", scores: { res: 0, rec: 25, tol: 0 } },
                  { text: "Functional and brief.", scores: { res: 10, rec: 10, tol: 10 } }
              ] 
            },
            { q: "Your 'Ideal' Saturday night is:", cat: "Environment",
              a: [
                  { text: "A concert with 5,000 strangers.", scores: { res: 25, rec: 0, tol: 30 } },
                  { text: "Reading/Gaming alone.", scores: { res: 0, rec: 30, tol: 0 } },
                  { text: "Dinner with 3 close friends.", scores: { res: 15, rec: 15, tol: 10 } }
              ] 
            },
            { q: "When people call you 'Extroverted,' you:", cat: "Identity",
              a: [
                  { text: "Agree. I love people.", scores: { res: 25, rec: 0, tol: 20 } },
                  { text: "Laugh. They only see the mask.", scores: { res: 10, rec: 20, tol: 10 } },
                  { text: "Disagree. I'm an introvert who can talk.", scores: { res: 15, rec: 25, tol: 5 } }
              ] 
            },
            { q: "A conflict breaks out in the group. You:", cat: "Conflict",
              a: [
                  { text: "Jump in to mediate/resolve.", scores: { res: 20, rec: 0, tol: 15 } },
                  { text: "Shut down emotionally and leave.", scores: { res: 0, rec: 30, tol: 0 } },
                  { text: "Watch the drama silently.", scores: { res: 10, rec: 10, tol: 10 } }
              ] 
            },
            { q: "How much 'Alone Time' do you need per day?", cat: "Baseline",
              a: [
                  { text: "Zero. I hate being alone.", scores: { res: 30, rec: -10, tol: 20 } },
                  { text: "At least 4 hours.", scores: { res: 0, rec: 25, tol: 0 } },
                  { text: "1-2 hours to decompress.", scores: { res: 15, rec: 15, tol: 10 } }
              ] 
            },
            { q: "You are at a wedding. You leave:", cat: "Duration",
              a: [
                  { text: "When the lights come on at 3 AM.", scores: { res: 30, rec: 0, tol: 25 } },
                  { text: "Immediately after the cake is cut.", scores: { res: 0, rec: 25, tol: 0 } },
                  { text: "Somewhere in the middle.", scores: { res: 15, rec: 15, tol: 10 } }
              ] 
            },
            { q: "Public speaking makes you feel:", cat: "Efficacy",
              a: [
                  { text: "Powerful. I love the stage.", scores: { res: 25, rec: 0, tol: 25 } },
                  { text: "Sick to my stomach.", scores: { res: 0, rec: 30, tol: 0 } },
                  { text: "Nervous but I can handle it.", scores: { res: 15, rec: 15, tol: 10 } }
              ] 
            },
            { q: "Why are you doing this audit?", cat: "Final",
              a: [
                  { text: "Because I'm currently avoiding social interaction.", scores: { res: 0, rec: 25, tol: 0 } },
                  { text: "To optimize my social schedule.", scores: { res: 20, rec: 0, tol: 10 } },
                  { text: "Curiosity.", scores: { res: 10, rec: 10, tol: 10 } }
              ] 
            }
        ];

        const archetypes = {
            "Nuclear": { title: "The Nuclear Reactor", summary: "You generate energy from crowds. You don't have a limit; you have an engine.", desc: "You are a rare ultra-extrovert. While others drain, you recharge in social settings. You likely struggle with solitude and find silence 'loud.' You are the natural leader of any group, but watch out for burning others out with your pace." },
            "AA": { title: "The AA Battery", summary: "Small, reliable, but once you're out, you're OUT.", desc: "You are the classic introvert. You have enough charge for a specific task or evening, but you require 100% isolation to hit full capacity again. You are highly observant and deep, but 'networking' feels like manual labor to you." },
            "Solar": { title: "Solar Powered", summary: "You recharge based on the quality of the light (people).", desc: "You are an Ambivert. In the right 'sunlight' (good friends), you can last all night. In 'shade' (small talk/strangers), you drain in minutes. Your battery isn't about time; it's about vibes and connection." },
            "ShortCircuit": { title: "The Short Circuit", summary: "High intensity, high anxiety, rapid drain.", desc: "You dive into social situations with 100% effort, but your 'Social Anxiety Load' causes you to drain twice as fast as others. You are likely the most fun person at the party for exactly one hour, then you disappear without saying goodbye." }
        };

        let currentQ = 0;
        let totals = { res: 0, rec: 0, tol: 0 };

        window.startQuiz = function() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('quiz-interface').classList.remove('hidden');
            renderQuestion();
        }

        function renderQuestion() {
            if (currentQ >= questions.length) { finishQuiz(); return; }
            const q = questions[currentQ];
            document.getElementById('q-category').innerText = q.cat;
            document.getElementById('question-text').innerText = q.q;
            document.getElementById('progress-text').innerText = `${String(currentQ + 1).padStart(2, '0')} / ${questions.length}`;
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            q.a.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "option-card w-full p-6 text-left font-mono text-xs uppercase tracking-widest text-slate-300";
                btn.innerText = opt.text;
                btn.onclick = () => {
                    totals.res += opt.scores.res;
                    totals.rec += opt.scores.rec;
                    totals.tol += opt.scores.tol;
                    currentQ++;
                    renderQuestion();
                };
                container.appendChild(btn);
            });
        }

        function finishQuiz() {
            let key = "Solar";
            const { res, rec, tol } = totals;
            if (res > 280) key = "Nuclear";
            else if (rec > 280) key = "AA";
            else if (rec > 150 && res > 150) key = "ShortCircuit";
            
            const data = archetypes[key];
            document.getElementById('quiz-interface').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('result-title').innerText = data.title;
            document.getElementById('result-summary').innerText = data.summary;
            
            document.getElementById('res-val').innerText = res > 150 ? "Infinite" : "Limited";
            document.getElementById('rec-val').innerText = rec > 150 ? "Slow" : "Rapid";
            document.getElementById('lim-val').innerText = tol > 150 ? "High" : "Low";
            document.getElementById('cla-val').innerText = key;

            if (window.saveTestResult) window.saveTestResult({ testId: 'social_battery', archetype: key, metrics: totals });
        }
    </script>
</body>
</html>