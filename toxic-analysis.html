<!DOCTYPE html>
<html lang="en">
<head>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-ML3F7KLZ');</script>
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Toxic Detachment Analysis | C-137 Scanner</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
 <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Space+Grotesk:wght@300;500;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script type="module" src="firebase-config.js"></script>
  <script type="module" src="game-engine.js"></script> <script src="components.js" defer></script>
<script type="module" src="assets/ux-core.js"></script> 

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { 
            display: ['Orbitron', 'sans-serif'], 
            body: ['Space Grotesk', 'sans-serif'], 
            code: ['Share Tech Mono', 'monospace'] 
          },
          colors: { 
            toxicGreen: '#39ff14', 
            toxicPurple: '#9d00ff', 
            voidBlack: '#020202' 
          },
          animation: {
            'scan': 'scan 2s linear infinite',
            'pulse-fast': 'pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite',
          },
          keyframes: {
            scan: {
              '0%': { transform: 'translateY(-100%)' },
              '100%': { transform: 'translateY(500%)' }
            }
          }
        }
      }
    }
  </script>

  <style>
    body { 
        background-color: #020202; 
        color: #fff; 
        background-image: radial-gradient(circle at 50% 0%, #120024 0%, #020202 80%);
        overflow-x: hidden;
    }
    
    .glass-panel { 
        background: rgba(255, 255, 255, 0.02); 
        backdrop-filter: blur(24px); 
        border: 1px solid rgba(255, 255, 255, 0.06); 
        box-shadow: 0 20px 50px -10px rgba(0,0,0,0.8);
    }
    
    .choice-card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border-left: 2px solid transparent;
    }
    .choice-card:hover {
        background: rgba(157, 0, 255, 0.08);
        border-left-color: #9d00ff;
        transform: translateX(6px);
        box-shadow: 0 0 20px rgba(157, 0, 255, 0.1);
    }
    .choice-card:active { transform: scale(0.98); }

    .scan-overlay {
        position: absolute; inset: 0; pointer-events: none; z-index: 50;
        background: linear-gradient(to bottom, transparent, rgba(57, 255, 20, 0.1), transparent);
        height: 100px;
        opacity: 0.2;
    }
  </style>
</head>

<body class="flex flex-col min-h-screen">
  
  <quiz-header></quiz-header>

  <main class="flex-grow flex items-center justify-center p-4 py-12 relative">
    
    <div class="fixed top-20 left-10 w-64 h-64 bg-toxicGreen rounded-full blur-[120px] opacity-5 pointer-events-none"></div>
    <div class="fixed bottom-20 right-10 w-96 h-96 bg-toxicPurple rounded-full blur-[140px] opacity-10 pointer-events-none"></div>

    <div id="game-container" class="w-full max-w-4xl min-h-[650px] relative">
        
        <div id="start-screen" class="glass-panel rounded-[32px] p-10 md:p-16 text-center flex flex-col items-center justify-center h-full relative overflow-hidden">
            <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5"></div>
            
            <div class="mb-8 relative group">
                <div class="absolute -inset-4 bg-toxicPurple blur-xl opacity-20 group-hover:opacity-40 transition duration-700 animate-pulse-fast"></div>
                <div class="w-24 h-24 rounded-2xl bg-black border border-toxicPurple flex items-center justify-center text-4xl text-toxicPurple relative z-10">
                    <i class="fas fa-biohazard"></i>
                </div>
            </div>

            <h1 class="font-display text-5xl md:text-7xl font-black tracking-tighter text-white mb-4">
                TOXIC <span class="text-transparent bg-clip-text bg-gradient-to-r from-toxicPurple to-white">ANALYSIS</span>
            </h1>
            
            <p class="font-body text-slate-400 text-lg max-w-xl leading-relaxed mb-10">
                Using the <strong>Ricklaxation Algorithm</strong>, we will separate your healthy psyche from your toxic waste. Are you a god, or just a narcissist?
            </p>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 w-full max-w-2xl mb-12">
                <div class="p-3 rounded bg-white/5 border border-white/5 text-[10px] font-code uppercase tracking-widest text-slate-400">
                    <i class="fas fa-brain text-toxicPurple mr-2"></i> 12 Scenarios
                </div>
                <div class="p-3 rounded bg-white/5 border border-white/5 text-[10px] font-code uppercase tracking-widest text-slate-400">
                    <i class="fas fa-check-circle text-toxicGreen mr-2"></i> 99.9% Accuracy
                </div>
                <div class="p-3 rounded bg-white/5 border border-white/5 text-[10px] font-code uppercase tracking-widest text-slate-400">
                    <i class="fas fa-database text-blue-400 mr-2"></i> Firestore Sync
                </div>
                <div class="p-3 rounded bg-white/5 border border-white/5 text-[10px] font-code uppercase tracking-widest text-slate-400">
                    <i class="fas fa-clock text-yellow-500 mr-2"></i> 3 Min Scan
                </div>
            </div>

            <button onclick="window.startAnalysis()" class="relative overflow-hidden px-12 py-5 rounded-xl bg-toxicPurple text-white font-display font-bold text-lg tracking-widest hover:scale-105 transition-all duration-300 shadow-[0_0_40px_rgba(157,0,255,0.4)] cursor-pointer">
                <span class="relative z-10">INITIALIZE SCANNER</span>
                <div class="absolute inset-0 bg-white/20 translate-y-full hover:translate-y-0 transition-transform duration-300"></div>
            </button>
        </div>

        <div id="active-game" class="hidden glass-panel rounded-[32px] p-8 md:p-12 relative flex flex-col justify-between h-full min-h-[600px] overflow-hidden">
            <div class="scan-overlay animate-scan"></div>

            <div class="flex justify-between items-end mb-8 border-b border-white/5 pb-6">
                <div>
                    <div class="font-code text-[10px] text-toxicGreen uppercase tracking-[0.2em] mb-1">Processing Neural Path...</div>
                    <div class="font-display text-2xl text-white">Subject C-137</div>
                </div>
                <div class="text-right">
                    <span class="font-display text-4xl font-bold text-white" id="q-current">01</span>
                    <span class="font-display text-xl text-slate-600">/ 12</span>
                </div>
            </div>

            <div class="flex-grow flex flex-col justify-center space-y-10 z-10">
                <h2 id="question-text" class="font-body text-2xl md:text-3xl font-bold text-white leading-tight">
                    Loading Scenario...
                </h2>

                <div id="choices-grid" class="grid grid-cols-1 gap-4">
                    </div>
            </div>

            <div class="w-full h-1 bg-white/5 mt-10 rounded-full overflow-hidden">
                <div id="progress-bar" class="h-full bg-gradient-to-r from-toxicGreen to-toxicPurple transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>

        <div id="results-screen" class="hidden glass-panel rounded-[32px] relative overflow-hidden flex flex-col">
            
            <div class="p-8 md:p-10 text-center relative z-10 border-b border-white/5">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black border border-white/10 text-slate-400 font-code text-[9px] uppercase tracking-widest mb-4">
                    <span class="w-2 h-2 rounded-full bg-toxicGreen animate-pulse"></span> Analysis Complete
                </div>
                <h2 class="font-display text-4xl md:text-5xl font-black text-white">PSYCHE SPLIT</h2>
                <p class="font-body text-slate-400 text-sm mt-2">Detachment Simulation Results</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 min-h-[400px]">
                
                <div class="relative p-8 md:p-12 flex flex-col justify-center items-center text-center bg-gradient-to-b from-toxicGreen/5 to-transparent border-r border-white/5">
                    <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-10"></div>
                    <i class="fas fa-heart text-5xl text-toxicGreen mb-4 drop-shadow-[0_0_15px_rgba(57,255,20,0.5)]"></i>
                    <div class="font-code text-xs text-toxicGreen uppercase tracking-[0.3em] mb-2">Healthy Component</div>
                    <div id="score-healthy" class="font-display text-6xl font-black text-white mb-4">0%</div>
                    <p class="font-body text-xs text-slate-400 max-w-xs leading-relaxed">
                        Empathy, Morality, Social Adherence. The part of you that wants to be loved.
                    </p>
                </div>

                <div class="relative p-8 md:p-12 flex flex-col justify-center items-center text-center bg-gradient-to-b from-toxicPurple/5 to-transparent">
                    <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-10"></div>
                    <i class="fas fa-biohazard text-5xl text-toxicPurple mb-4 drop-shadow-[0_0_15px_rgba(157,0,255,0.5)]"></i>
                    <div class="font-code text-xs text-toxicPurple uppercase tracking-[0.3em] mb-2">Toxic Component</div>
                    <div id="score-toxic" class="font-display text-6xl font-black text-white mb-4">0%</div>
                    <p class="font-body text-xs text-slate-400 max-w-xs leading-relaxed">
                        Narcissism, Ego, Control. The part of you that believes it is a god.
                    </p>
                </div>

            </div>

            <div class="bg-black/40 p-8 border-t border-white/10 flex flex-col md:flex-row items-center justify-between gap-6">
                <div class="flex items-center gap-4">
                    <div id="archetype-icon" class="w-16 h-16 rounded-2xl bg-white/5 flex items-center justify-center text-3xl">‚ùì</div>
                    <div>
                        <div class="text-[10px] font-code text-slate-500 uppercase tracking-widest mb-1">Database Match</div>
                        <div id="archetype-name" class="font-display text-2xl font-bold text-white">CALCULATING...</div>
                    </div>
                </div>
                
                <div class="flex gap-3">
                    <button onclick="window.shareResult()" class="px-6 py-3 rounded-xl bg-white text-black font-bold text-xs uppercase tracking-widest hover:bg-toxicGreen transition flex items-center gap-2">
                        <i class="fas fa-copy"></i> Share
                    </button>
                    <a href="/rickandmortyhub.html" class="px-6 py-3 rounded-xl border border-white/20 text-white font-bold text-xs uppercase tracking-widest hover:bg-white/10 transition">
                        Hub
                    </a>
                </div>
            </div>

        </div>

    </div>
  </main>

  






<div class="qr-seo-wrapper">
    <style>
        .qr-seo-wrapper { display: flex; flex-direction: column; gap: 3rem; width: 100%; max-width: 1200px; margin: 4rem auto; padding: 0 1rem; font-family: system-ui, -apple-system, sans-serif; color: #94a3b8; line-height: 1.6; }
        .qr-hub-card { position: relative; background: linear-gradient(145deg, #060b18, #0f172a); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 24px; overflow: hidden; box-shadow: 0 20px 50px -10px rgba(0, 0, 0, 0.5); padding: 2.5rem; display: flex; flex-direction: column; }
        
        /* THEMES */
        .theme-green { border-left: 4px solid #10b981; } .theme-green h2 span { color: #34d399; } .theme-green .qr-badge { background: rgba(16, 185, 129, 0.1); border-color: rgba(16, 185, 129, 0.2); color: #6ee7b7; } .theme-green a { color: #34d399; }
        .theme-purple { border-left: 4px solid #a855f7; } .theme-purple h2 span { color: #c084fc; } .theme-purple .qr-badge { background: rgba(168, 85, 247, 0.1); border-color: rgba(168, 85, 247, 0.2); color: #d8b4fe; } .theme-purple a { color: #c084fc; }
        .theme-cyan { border-left: 4px solid #06b6d4; } .theme-cyan h2 span { color: #22d3ee; } .theme-cyan .qr-badge { background: rgba(6, 182, 212, 0.1); border-color: rgba(6, 182, 212, 0.2); color: #67e8f9; } .theme-cyan a { color: #22d3ee; }
        .theme-amber { border-left: 4px solid #f59e0b; } .theme-amber h2 span { color: #fbbf24; } .theme-amber .qr-badge { background: rgba(245, 158, 11, 0.1); border-color: rgba(245, 158, 11, 0.2); color: #fcd34d; } .theme-amber a { color: #fbbf24; }

        /* LAYOUT */
        .qr-card-content { position: relative; z-index: 10; display: flex; flex-direction: column; gap: 2rem; height: 100%; }
        @media (min-width: 900px) { .qr-card-content { flex-direction: row; align-items: flex-start; } }
        .qr-main-col { flex: 1; }
        .qr-side-col { width: 100%; max-width: 320px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 1.5rem; backdrop-filter: blur(10px); flex-shrink: 0; }
        
        /* ELEMENTS */
        .qr-badge { display: inline-flex; align-items: center; gap: 8px; padding: 4px 12px; border-radius: 99px; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 1rem; font-weight: 700; }
        .qr-hub-card h2 { color: #fff; font-size: 1.8rem; margin: 0 0 1rem 0; line-height: 1.2; letter-spacing: -0.02em; }
        .qr-hub-card p { margin-bottom: 1.5rem; font-size: 0.95rem; text-align: justify; }
        .qr-hub-card strong { color: #fff; }
        .qr-hub-card a { font-weight: 600; text-decoration: none; border-bottom: 1px solid transparent; transition: 0.2s; }
        .qr-hub-card a:hover { border-bottom-color: currentColor; }
        
        /* SIDEBAR */
        .qr-sidebar-link { display: flex; align-items: center; gap: 12px; padding: 10px; margin-bottom: 8px; background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 10px; text-decoration: none !important; }
        .qr-sidebar-link:hover { background: rgba(255, 255, 255, 0.08); }
        .qr-link-text { display: flex; flex-direction: column; }
        .qr-link-head { color: #e2e8f0; font-size: 0.85rem; font-weight: 700; }
        .qr-link-sub { color: #64748b; font-size: 0.7rem; }
        .qr-icon { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.05); border-radius: 6px; }

        /* GRIDS */
        .qr-game-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 10px; padding-top: 1.5rem; border-top: 1px solid rgba(255, 255, 255, 0.1); }
        .qr-mini-link { padding: 8px; background: rgba(0,0,0,0.3); border-radius: 8px; border: 1px solid rgba(255,255,255,0.05); text-align: center; font-size: 0.75rem; color: #cbd5e1 !important; }
        .qr-mini-link:hover { background: rgba(255,255,255,0.1); }
        .qr-link-matrix { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 1rem; }
        .qr-matrix-item { font-size: 0.75rem; padding: 4px 10px; border-radius: 4px; background: rgba(251, 191, 36, 0.1); color: #fbbf24 !important; border: 1px solid rgba(251, 191, 36, 0.2); }
        .qr-matrix-item:hover { background: rgba(251, 191, 36, 0.2); }

        @media (max-width: 600px) { .qr-hub-card { padding: 1.5rem; } .qr-side-col { max-width: 100%; } }
    </style>

    <div class="qr-hub-card theme-green">
        <div class="qr-card-content">
            <div class="qr-main-col">
                <div class="qr-badge"><i class="fas fa-stopwatch"></i> Time Attack Mode</div>
                <h2>Beat The Clock: <span>High-Stakes Puzzles</span></h2>
                <p>
                    In the <strong>Quiz Realm Arcade</strong>, intelligence is nothing without speed. Our game modes are built to simulate high-pressure environments where hesitation leads to failure. Challenges like <a href="rapid.html">Rapid Fire</a> force you to make split-second decisions, training your brain to retrieve information instantly rather than just memorizing it.
                </p>
                <p>
                    We track your "Time-to-Answer" metrics across all modes, from the deductive grids of <a href="fusion-core.html">Logic League</a> to the fast-paced pattern matching of <a href="nexus.html">Connections</a>. Are you faster than 90% of the global player base? Only the leaderboard tells the truth. Jump into a session now and set a new personal best.
                </p>
                
                <div style="font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em; margin-top: 1rem; color: #fff;">Speed Modules</div>
                <div class="qr-game-grid">
                    <a href="/rapid.html" class="qr-mini-link">Rapid Fire</a>
                    <a href="/mini-crossword.html" class="qr-mini-link">Speed Cross</a>
                    <a href="/odd-one-out.html" class="qr-mini-link">Odd One Out</a>
                    <a href="/cryptex.html" class="qr-mini-link">Cryptex</a>
                    <a href="/word-ladder.html" class="qr-mini-link">Ladder Run</a>
                    <a href="/timeline-history.html" class="qr-mini-link">Timeline</a>
                </div>
            </div>
            <div class="qr-side-col">
                <div style="margin-bottom:1rem; font-size:0.7rem; text-transform:uppercase; letter-spacing:0.1em;">Compete</div>
                <a href="/daily.html" class="qr-sidebar-link">
                    <div class="qr-icon"><i class="fas fa-trophy text-green-400"></i></div>
                    <div class="qr-link-text"><span class="qr-link-head">Daily Rank</span><span class="qr-link-sub">Today's Leaderboard</span></div>
                </a>
                <a href="/arcade.html" class="qr-sidebar-link">
                    <div class="qr-icon"><i class="fas fa-list-ol text-green-400"></i></div>
                    <div class="qr-link-text"><span class="qr-link-head">All Games</span><span class="qr-link-sub">Browse Collection</span></div>
                </a>
            </div>
        </div>
    </div>

    <div class="qr-hub-card theme-purple">
        <div class="qr-card-content">
            <div class="qr-main-col">
                <div class="qr-badge"><i class="fas fa-dungeon"></i> Hardcore Mode</div>
                <h2>The Deep End: <span>Impossible Trivia</span></h2>
                <p>
                    Casual fans need not apply. The <strong>Knowledge Nexus</strong> is home to our "Deep Dive" hubs, where we house questions that go far beyond the movie posters. We test your knowledge of specific issue numbers, alien dialects, and background Easter eggs found in the <a href="marvel.html">Marvel</a> and <a href="dc.html">DC Universes</a>.
                </p>
                <p>
                    Our algorithm adjusts to your skill level. If you consistently answer easy questions correctly, the system will begin serving "Omega-Level" threats‚Äîquestions designed to stump even professional archivists. From <a href="rick-and-morty.html">Rick and Morty's</a> multidimensional coordinates to the exact dates of historical battles, this is the ultimate test of your fandom retention.
                </p>
            </div>
            <div class="qr-side-col">
                <div style="margin-bottom:1rem; font-size:0.7rem; text-transform:uppercase; letter-spacing:0.1em;">Select Challenge</div>
                <a href="/encyclopedia/marvel.html" class="qr-sidebar-link">
                    <div class="qr-icon"><i class="fas fa-hand-rock text-purple-400"></i></div>
                    <div class="qr-link-text"><span class="qr-link-head">Infinity War</span><span class="qr-link-sub">Marvel Hard Mode</span></div>
                </a>
                <a href="/encyclopedia/superman.html" class="qr-sidebar-link">
                    <div class="qr-icon"><i class="fas fa-city text-purple-400"></i></div>
                    <div class="qr-link-text"><span class="qr-link-head">Gotham City</span><span class="qr-link-sub">DC Hard Mode</span></div>
                </a>
                <a href="/christmas-hub.html" class="qr-sidebar-link">
                    <div class="qr-icon"><i class="fas fa-gift text-purple-400"></i></div>
                    <div class="qr-link-text"><span class="qr-link-head">Holiday Lore</span><span class="qr-link-sub">Seasonal Facts</span></div>
                </a>
            </div>
        </div>
    </div>

    <div class="qr-hub-card theme-cyan">
        <div class="qr-card-content">
            <div class="qr-main-col">
                <div class="qr-badge"><i class="fas fa-crown"></i> Prestige System</div>
                <h2>Global Status: <span>Earn Your Rank</span></h2>
                <p>
                    In the Quiz Realm, knowledge is currency. Our <strong>Prestige System</strong> rewards dedicated players with exclusive profile borders, titles, and badges. Completing a "Perfect Run" in the Daily Challenge or achieving a 7-day streak grants you XP multipliers that accelerate your rise through the ranks.
                </p>
                <p>
                    Don't just play anonymously. Sign in to track your <strong>Lifetime Stats</strong>. See which categories are your strongest (e.g., "Science Geek") and where you need improvement. Compare your "Brain Age" and reaction times against friends to see who truly has the sharpest mind in your circle.
                </p>
            </div>
            <div class="qr-side-col">
                <div style="margin-bottom:1rem; font-size:0.7rem; text-transform:uppercase; letter-spacing:0.1em;">Your Legacy</div>
                <a href="/achievements.html" class="qr-sidebar-link">
                    <div class="qr-icon"><i class="fas fa-award text-cyan-400"></i></div>
                    <div class="qr-link-text"><span class="qr-link-head">Hall of Fame</span><span class="qr-link-sub">View Trophies</span></div>
                </a>
                <a href="/profile.html" class="qr-sidebar-link">
                    <div class="qr-icon"><i class="fas fa-sliders-h text-cyan-400"></i></div>
                    <div class="qr-link-text"><span class="qr-link-head">Customize</span><span class="qr-link-sub">Edit Avatar</span></div>
                </a>
            </div>
        </div>
    </div>

    <div class="qr-hub-card theme-amber">
        <div class="qr-card-content">
            <div class="qr-main-col">
                <div class="qr-badge"><i class="fas fa-graduation-cap"></i> Study Guide</div>
                <h2>The Library: <span>Prep for Trivia Night</span></h2>
                <p>
                    Are you the weak link in your pub trivia team? The <strong>Quiz Realm Library</strong> is your training ground. We have categorized thousands of questions into study-friendly blocks. Spend 10 minutes a day in our "Geography" or "Classic Literature" sections, and you will see immediate improvements in your general knowledge retention.
                </p>
                <p>
                    Our database covers everything from <strong>Ancient Civilizations</strong> to <strong>Modern Tech</strong>. Use the quick links below to target your weak spots. Whether you need to memorize capital cities or understand basic quantum mechanics, we have a quiz module ready for you.
                </p>

                <div style="font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em; margin-top: 1.5rem; color: #fff;">Study Topics</div>
                <div class="qr-link-matrix">
                    <a href="/categories.html" class="qr-matrix-item">Periodic Table</a>
                    <a href="/categories.html" class="qr-matrix-item">World Wars</a>
                    <a href="/categories.html" class="qr-matrix-item">Film Directors</a>
                    <a href="/categories.html" class="qr-matrix-item">Human Anatomy</a>
                    <a href="/categories.html" class="qr-matrix-item">Solar System</a>
                    <a href="/categories.html" class="qr-matrix-item">Capitals</a>
                    <a href="/categories.html" class="qr-matrix-item">Grammar</a>
                    <a href="/categories.html" class="qr-matrix-item">Coding</a>
                    <a href="/categories.html" class="qr-matrix-item">Fine Art</a>
                    <a href="/categories.html" class="qr-matrix-item">Olympics</a>
                    <a href="/categories.html" class="qr-matrix-item">Oscar Winners</a>
                    <a href="/categories.html" class="qr-matrix-item">Philosophy</a>
                </div>
            </div>
            
            <div class="qr-side-col">
                <div style="margin-bottom:1rem; font-size:0.7rem; text-transform:uppercase; letter-spacing:0.1em;">Resources</div>
                <a href="about.html" class="qr-sidebar-link">
                    <div class="qr-icon"><i class="fas fa-users text-amber-400"></i></div>
                    <div class="qr-link-text"><span class="qr-link-head">Our Team</span><span class="qr-link-sub">Who we are</span></div>
                </a>
                <a href="FAQ.html" class="qr-sidebar-link">
                    <div class="qr-icon"><i class="fas fa-life-ring text-amber-400"></i></div>
                    <div class="qr-link-text"><span class="qr-link-head">Support</span><span class="qr-link-sub">Get Help</span></div>
                </a>
                <a href="privacy.html" class="qr-sidebar-link">
                    <div class="qr-icon"><i class="fas fa-shield-alt text-amber-400"></i></div>
                    <div class="qr-link-text"><span class="qr-link-head">Security</span><span class="qr-link-sub">Your Data</span></div>
                </a>
            </div>
        </div>
    </div>

</div>

  <quiz-footer></quiz-footer>

  <script>
    // 1. GAME DATA (12 Questions)
    const questions = [
        {
            text: "Someone takes credit for your idea in a meeting. Your internal reaction is:",
            choices: [
                { text: "Rage. I will destroy their reputation systematically.", toxic: 100 },
                { text: "Annoyance, but I'll correct them politely.", toxic: 20 },
                { text: "It doesn't matter, as long as the work gets done.", toxic: 0 }
            ]
        },
        {
            text: "You are the smartest person in the room. How does that feel?",
            choices: [
                { text: "Exhausting. I am surrounded by idiots.", toxic: 80 },
                { text: "Comforting. I can help guide these people.", toxic: 10 },
                { text: "I don't think about hierarchy like that.", toxic: 0 }
            ]
        },
        {
            text: "If you could press a button to erase one person you hate from existence, no consequences:",
            choices: [
                { text: "I'd press it before you finished the sentence.", toxic: 100 },
                { text: "I'd keep the button, just in case.", toxic: 50 },
                { text: "No. Nobody deserves that.", toxic: 0 }
            ]
        },
        {
            text: "When you make a mistake, who do you blame?",
            choices: [
                { text: "The universe/circumstances. It wasn't my fault.", toxic: 70 },
                { text: "Myself. I am garbage.", toxic: 10 }, 
                { text: "I analyze the failure and fix it.", toxic: 0 }
            ]
        },
        {
            text: "Do you believe you are the 'Main Character' of reality?",
            choices: [
                { text: "Obviously. Everyone else is an NPC.", toxic: 100 },
                { text: "I'm the main character of my own life, sure.", toxic: 30 },
                { text: "No, we are all insignificant dust.", toxic: 0 }
            ]
        },
        {
            text: "An ex-partner begs for forgiveness after hurting you.",
            choices: [
                { text: "I forgive them, but I cut them off.", toxic: 10 },
                { text: "I pretend to forgive them to manipulate them later.", toxic: 90 },
                { text: "I take them back immediately because I'm lonely.", toxic: 40 }
            ]
        },
        {
            text: "You discover the universe is a meaningless simulation.",
            choices: [
                { text: "Great. That means I can do whatever I want.", toxic: 80 },
                { text: "I am terrified and depressed.", toxic: 20 },
                { text: "Don't think about it.", toxic: 50 } 
            ]
        },
        {
            text: "To achieve your ultimate goal, would you betray a friend?",
            choices: [
                { text: "Yes. Sentimentality is a weakness.", toxic: 100 },
                { text: "Only if the goal helps everyone.", toxic: 40 },
                { text: "Never.", toxic: 0 }
            ]
        },
        {
            text: "Someone insults your intelligence.",
            choices: [
                { text: "Prove them wrong with a complex, humiliating display.", toxic: 90 },
                { text: "Laugh it off. Who cares?", toxic: 0 },
                { text: "Obsess over it for 3 days.", toxic: 30 }
            ]
        },
        {
            text: "How do you view 'Love'?",
            choices: [
                { text: "A chemical reaction that compels animals to breed.", toxic: 80 },
                { text: "The only thing that makes this nightmare bearable.", toxic: 10 },
                { text: "A vulnerability that can be exploited.", toxic: 100 }
            ]
        },
        {
            text: "You have the power to cure all disease, but you get zero credit for it.",
            choices: [
                { text: "Do it instantly.", toxic: 0 },
                { text: "Do it, but leave a hidden signature so they know.", toxic: 40 },
                { text: "If I'm not a god, what's the point? Pass.", toxic: 100 }
            ]
        },
        {
            text: "Finally, what are you?",
            choices: [
                { text: "A God.", toxic: 100 },
                { text: "A Victim.", toxic: 60 },
                { text: "A Human.", toxic: 0 }
            ]
        }
    ];

    let currentQ = 0;
    let totalScore = 0;
    let startTime = 0;

    // 2. INITIALIZATION
    window.startAnalysis = function() {
        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('active-game').classList.remove('hidden');
        startTime = Date.now();
        renderQuestion();
    };

    // 3. RENDER LOGIC
    function renderQuestion() {
        if (currentQ >= questions.length) {
            finishGame();
            return;
        }

        const q = questions[currentQ];
        document.getElementById('question-text').innerText = q.text;
        document.getElementById('q-current').innerText = (currentQ + 1).toString().padStart(2, '0');
        document.getElementById('progress-bar').style.width = ((currentQ) / questions.length) * 100 + '%';

        const grid = document.getElementById('choices-grid');
        grid.innerHTML = '';

        q.choices.forEach(c => {
            const btn = document.createElement('button');
            btn.className = "choice-card w-full p-6 glass-panel rounded-2xl text-left flex items-center justify-between group";
            btn.innerHTML = `
                <span class="font-body text-slate-200 text-lg group-hover:text-toxicPurple transition-colors">${c.text}</span>
                <i class="fas fa-chevron-right text-white/20 group-hover:text-toxicPurple transition-colors"></i>
            `;
            btn.onclick = () => {
                totalScore += c.toxic;
                currentQ++;
                renderQuestion();
            };
            grid.appendChild(btn);
        });
    }

    // 4. RESULTS LOGIC
    async function finishGame() {
        document.getElementById('active-game').classList.add('hidden');
        document.getElementById('results-screen').classList.remove('hidden');

        const maxScore = questions.length * 100;
        const toxicPercent = Math.round((totalScore / maxScore) * 100);
        const healthyPercent = 100 - toxicPercent;

        // Animate Numbers
        animateValue("score-toxic", 0, toxicPercent, 1500);
        animateValue("score-healthy", 0, healthyPercent, 1500);

        // Determine Archetype
        let archetype = "";
        let color = "";
        let icon = "";

        if (toxicPercent >= 80) {
            archetype = "RICK PRIME (Pure Toxicity)";
            color = "text-toxicPurple";
            icon = '<i class="fas fa-skull text-toxicPurple"></i>';
        } else if (toxicPercent >= 50) {
            archetype = "RICK C-137 (Balanced Chaos)";
            color = "text-blue-400";
            icon = '<i class="fas fa-flask text-blue-400"></i>';
        } else if (toxicPercent >= 30) {
            archetype = "MORTY SMITH (Anxious)";
            color = "text-yellow-400";
            icon = '<i class="fas fa-child text-yellow-400"></i>';
        } else {
            archetype = "JERRY SMITH (Ignorant Bliss)";
            color = "text-green-400";
            icon = '<i class="fas fa-gamepad text-green-400"></i>';
        }

        document.getElementById('archetype-name').innerText = archetype;
        document.getElementById('archetype-name').className = `font-display text-2xl font-bold ${color}`;
        document.getElementById('archetype-icon').innerHTML = icon;

        // 5. DATABASE SAVE (Dynamic Import)
        try {
            const { db, auth } = await import('/firebase-config.js');
            const user = auth.currentUser;
            if (user) {
                await db.collection('users').doc(user.uid).collection('gameResults').add({
                    game: 'Toxic Analysis',
                    toxicScore: toxicPercent,
                    archetype: archetype,
                    timestamp: new Date()
                });
                console.log("Results saved to Firestore");
            }
        } catch (e) {
            console.warn("Firestore save skipped (Dev/Offline mode):", e);
        }
    }

    // Helper: Number Animation
    function animateValue(id, start, end, duration) {
        const range = end - start;
        const obj = document.getElementById(id);
        if(!obj) return;
        
        let current = start;
        const increment = end > start ? 1 : -1;
        const stepTime = Math.abs(Math.floor(duration / range));
        
        if (range === 0) { obj.innerText = end + "%"; return; }

        const timer = setInterval(function() {
            current += increment;
            obj.innerText = current + "%";
            if (current == end) { clearInterval(timer); }
        }, stepTime);
    }

    // Helper: Share
    window.shareResult = function() {
        const archetype = document.getElementById('archetype-name').innerText;
        const toxic = document.getElementById('score-toxic').innerText;
        const text = `I just scanned my psyche on the Central Finite Hub.\n\n‚ò£Ô∏è Toxicity: ${toxic}\nüß¨ Match: ${archetype}\n\nAre you a Rick or a Jerry?`;
        
        navigator.clipboard.writeText(text).then(() => {
            alert("Results copied to clipboard! Share it with the Council.");
        });
    }
  </script>
</body>
</html>